<template name="connect">
  <script>
    var tryLogin = function () {
      FB.getLoginStatus(function(response) {
        var fbid = response.authResponse.userID;
        if (response.status === 'connected') {
          FB.api("/me", function (response) {
            Router.go('/ballot/' + response.first_name.replace(/ /g, "-")
             + "/" + response.last_name.replace(/ /g, "-")
              + "/" + fbid, {replaceState: true});
          });
        } else {
          console.log('Not logged in.')
        }
      })
    };

    if (window.fbInited) {
      tryLogin();
    } else {
      var oldFbAsyncInit = window.fbAsyncInit;
      window.fbAsyncInit = function () {
        oldFbAsyncInit();
        tryLogin();
      };
    }
  </script>
<div class="home-container">
  <h1>Create your ballot</h1>
  <p>We need you to connect with Facebook so we can create a page with your recommendations and comments.</p>
  <p><a href="#" id="connect-with-facebook" class="btn btn-default btn-large">Connect with Facebook</a></p>
</div>
</template>
